
\input{config.tex}
\begin{document}
\maketitle

\section{Implementation of explicit methods}
In this report we are going to implement explicit methods to solve three different partial differential equations in two dimensions.
\subsection{Heat Equation}
We will begin with the numerical solution of the heat equation:
\begin{equation}
\frac{\partial u}{\partial t} = \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}.
\end{equation}
From the lecture we know that this problem may be solved by extension of the one dimensional explicit scheme:
\begin{equation}
\frac{U^{n+1}-U^{n}}{\triangle t} = b [\frac{\delta_x^2 U^n}{(\triangle x)^2} + \frac{\delta_y^2 U^n}{(\triangle y)^2} ].
\end{equation}
with b = 1 in our case. By expanding the central differences we arrive at:
\begin{equation}
U_{r,x}^{n+1} = U_{r,s}^n (1 - 2\mu_x - 2\mu_y) + \mu_x U_{r+1,s}^n + \mu_x U_{r-1,s}^n + \mu_y U_{r,s+1}^n + \mu_y U_{r,s-1}^n.
\label{eq:heat}
\end{equation}
Equation~\ref{eq:heat} my be implemented in matlab.  As we are using a symmetric grid we have $\mu_x = \mu_y$ which leads to the implementation in listing~\ref{lst:expHeat}: 
\lstinputlisting[language=matlab,caption={Explicit solution of the heat equation in two dimensions.},label=lst:expHeat,captionpos=b]{code/heat2d.tex}

\subsection{Wave equation}
Next we are going to implement an explicit scheme to solve the wave equation:
\begin{equation}
\frac{\partial^2 u}{\partial t^2} = \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}.
\end{equation}
Approximating the second derivatives with central differences and solving for $U_{r,s}^{n+1}$ we obtain the scheme:
\begin{align*}
U_{r,s}^{n+1} = U_{r,s}(2 - 2\mu_x - 2 \mu_y) - U_{r,s}^{n-1} \\
				 + \mu_x U_{r-1,s}^n + \mu_x U_{r+1,s}^n	  \\
				 + \mu_y U_{r,s-1}^n + \mu_y U_{r,s+1}.
\end{align*}
In comparison to listing~\ref{lst:expHeat} we only have to change the for loop to implement this scheme. We got:
\lstinputlisting[language=matlab,caption={Code for solving the wave equation.},label=lst:expWave,captionpos=b]{code/waveFor.tex}



\subsection{Transport equation}
Before we are going to consider the numerical stability and accuracy of these methods we will implement a final scheme to solve the transport equation:
\begin{equation}
\frac{\partial u}{\partial t} = \frac{\partial u}{\partial x} + \frac{\partial u}{\partial y}.
\end{equation} 
Using exclusively forward differences to approximate the first order differentials and solving for $U_{r,s}^{n+1}$ once more we obtain:
\begin{equation}
U_{r,s}^{n+1} = U_{r,s}^n (1 - \mu_x - \mu_y) + \mu_x U_{r+1,s} + \mu_y U_{r,s+1}.
\end{equation}
Which leads to the modified for-loop for the transport case:
\lstinputlisting[language=matlab,caption={Code for solving the two dimesional transport equation.},label=lst:expWave,captionpos=b]{code/transportFor.tex}


\section{Analysis}
Figure~\ref{fig:stableUnstable} shows stable and unstable solutions for the three equations. We will proceed with taking a close look at the numerical properties of the methods we described so far. 
\begin{figure}
\includegraphics[scale = 0.33]{images/heat.png}
\includegraphics[scale = 0.33]{images/wave.png}
\includegraphics[scale = 0.33]{images/transport.png}
\includegraphics[scale = 0.33]{images/heatUnstable.png}
\includegraphics[scale = 0.33]{images/waveUnstable.png}
\includegraphics[scale = 0.33]{images/t0p15dt0p1J30.png}
\caption{Numerical solutions computed using the schemes described above for stable (top row) and unstable (bottom row) grid ratios.}
\label{fig:stableUnstable}
\end{figure}





\subsection{Transport Equation}
\subsubsection{Exact Solution of Transport Equation}
As a solution for the transport equation of form

\begin{equation}
\frac{\delta u}{\delta t} = \frac{\delta u}{\delta x} + \frac{\delta u}{\delta y}
\end{equation}
with a given initial conditions, $u_0(x,y)$, and homogenous dirichet boundary conditions we propose a solution of the following form:
\begin{equation}
u(x,y,t) = u_0(x-vt,y-vt)
\label{proposal}
\end{equation}
Calculating the partial derivatives found in the transport equation we get
\begin{equation}
\frac{\delta u}{\delta t} =(-v) \frac{\delta u_0(x,y)}{\delta x} +(-v) \frac{\delta u_0(x,y)}{\delta y} 
\end{equation}

\begin{equation}
\frac{\delta u}{\delta x} = \frac{\delta u_0(x,y)}{\delta x} ,\frac{\delta u}{\delta y} = \frac{\delta u_0(x,y)}{\delta y} 
\end{equation}
Filling this then in the transport equation gives

\begin{equation}
-v\frac{\delta u_0}{\delta x}-v\frac{\delta u_0}{\delta y} = \frac{\delta u_0}{\delta x}+\frac{\delta u_0}{\delta y} 
\end{equation}

which fits when $v=-1$ and so our solution is
\begin{equation}
u(x,y,t)=u_0(x+t,y+t)
\end{equation}

\subsubsection{Error analysis of the transport problem}

The truncation error for the upwind scheme with $a=1$ can be found to be

\begin{equation}
T_j^n = -\frac{1}{2}(1-\nu)\Delta x u_{xx} + ...
\end{equation}
Which is first order in $\Delta x$, and therefore, under constant $\nu$, also first order in $\Delta t$.

We then now that the maximum error $E^n$ at a point in time $n$ is bound by a function of the same order. And this is what we see in figure \ref{errororrrTransport}

\begin{figure}[htbp] %  figure placement: here, top, bottom, or page
   \centering
   \includegraphics[width=15cm]{images/errororrrTransport} 
   \caption{The maximum error at time = 0.1 in function of the tilmestep at a constant $\nu$ of 0.3 }
   \label{errororrrTransport}
\end{figure}




\section{Another initial solution}


\end{document}
